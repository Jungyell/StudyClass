#!/usr/bin/env pwsh
// PowerShell 사용

$basedir=Split-Path $MyInvocation.MyCommand.Definition -Parent
// 스크립트 경로 설정

$exe=""
// exe 확장자 변수 초기화

if ($PSVersionTable.PSVersion -lt "6.0" -or $IsWindows) {
// PS 버전이 6.0 미만이거나 Windows 환경인지 확인

  # Fix case when both the Windows and Linux builds of Node
  # are installed in the same directory
  $exe=".exe"
// Windows 환경일 경우 exe 확장자 설정
}

$ret=0
// 반환 코드 변수 초기화

if (Test-Path "$basedir/node$exe") {
// 경로에 node 실행 파일 존재 확인

  # Support pipeline input
  if ($MyInvocation.ExpectingInput) {
// 파이프라인 입력 지원 확인

    $input | & "$basedir/node$exe"  "$basedir/../nopt/bin/nopt.js" $args
// 파이프라인 입력을 node와 nopt에 전달

  } else {

    & "$basedir/node$exe"  "$basedir/../nopt/bin/nopt.js" $args
// 입력 없이 node와 nopt 실행
  }

  $ret=$LASTEXITCODE
// 마지막 명령어의 종료 코드 저장

} else {

  # Support pipeline input
  if ($MyInvocation.ExpectingInput) {
// 파이프라인 입력 지원 확인

    $input | & "node$exe"  "$basedir/../nopt/bin/nopt.js" $args
// 파이프라인 입력을 기본 node와 nopt에 전달

  } else {

    & "node$exe"  "$basedir/../nopt/bin/nopt.js" $args
// 입력 없이 기본 node와 nopt 실행
  }

  $ret=$LASTEXITCODE
// 마지막 명령어의 종료 코드 저장
}

exit $ret
// 반환 코드로 종료
