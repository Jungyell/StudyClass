#!/usr/bin/env pwsh  // PowerShell을 사용하여 스크립트를 실행하도록 지정
$basedir=Split-Path $MyInvocation.MyCommand.Definition -Parent  // 스크립트의 디렉터리를 $basedir 변수에 저장

$exe=""  // $exe 변수 초기화
if ($PSVersionTable.PSVersion -lt "6.0" -or $IsWindows) {  // PowerShell 버전이 6.0 미만이거나 Windows인 경우
  # Fix case when both the Windows and Linux builds of Node
  # are installed in the same directory
  $exe=".exe"  // Windows 환경에서 실행 파일 확장자 설정
}
$ret=0  // $ret 변수 초기화
if (Test-Path "$basedir/node$exe") {  // $basedir 경로에 node 실행 파일이 존재하는지 확인
  # Support pipeline input
  if ($MyInvocation.ExpectingInput) {  // 파이프라인 입력이 있는 경우
    $input | & "$basedir/node$exe"  "$basedir/../editorconfig/bin/editorconfig" $args  // 파이프라인 입력을 node 실행 파일로 전달
  } else {
    & "$basedir/node$exe"  "$basedir/../editorconfig/bin/editorconfig" $args  // node 실행 파일로 스크립트 실행
  }
  $ret=$LASTEXITCODE  // 마지막 실행 명령의 종료 코드를 $ret에 저장
} else {
  # Support pipeline input
  if ($MyInvocation.ExpectingInput) {  // 파이프라인 입력이 있는 경우
    $input | & "node$exe"  "$basedir/../editorconfig/bin/editorconfig" $args  // 파이프라인 입력을 기본 node 실행 파일로 전달
  } else {
    & "node$exe"  "$basedir/../editorconfig/bin/editorconfig" $args  // 기본 node 실행 파일로 스크립트 실행
  }
  $ret=$LASTEXITCODE  // 마지막 실행 명령의 종료 코드를 $ret에 저장
}
exit $ret  // $ret 종료 코드로 스크립트 종료
